/*!
  * Modal - A basic modal
  * v0.0.5
  * https://github.com/jgallen23/modal
  * copyright JGA 2011
  * MIT License
  *//*
Fidel.Modal = Fidel.ViewController.extend({
  defaults: {
    id: 'FidelModalOverlay'
  },
  init: function() {
    $("body").delegate('#'+this.id, 'click', this.proxy(this.close));
  },
  close: function() {
    this._overlay.remove();
    this.emit('close');
  },
  showOverlay: function() {
    this._overlay = $('<div id="'+this.id+'"><div></div></div>');
    this._overlay.appendTo('body');
    return this._overlay;
  },
  showImage: function(e) {
    var $overlay = this.showOverlay();
    var img = e.target.parentNode.getAttribute('data-image');
    $overlay.find('div').css('background-image', 'url('+img+')');
    setTimeout(function() {
      $overlay.addClass('zoom');
      setTimeout(function() {
        $overlay.addClass('normal');
      }, 300);
    }, 50);
  },
  showModal: function(e) {
    var $overlay = this.showOverlay();
    var $node = $("#"+e.target.getAttribute('data-modal'));
    $overlay.css('opacity', '1');
    var windowH = $(window).height();
    var windowW = $(window).width();
    $node.show().css({
      'z-index': 1001,
      'position': 'absolute',
      'top': (windowH-$node.height())/2,
      'left': (windowW-$node.width())/2
    });
    var self = this;
    var handle = this.on('close', function() { //should switch to once
      $node.hide();
      self.removeListener(handle);
    });
  }
});
*/
var id="ModalOverlay",overlay=null,options={backgroundColor:"rgba(0,0,0,.9)"},showOverlay=function(){return overlay&&overlay.remove(),overlay=$('<div id="'+id+'"><div></div></div>'),overlay.css({position:"fixed",top:0,left:0,width:"100%",height:"100%","background-color":options.backgroundColor,"z-index":1e3,opacity:0}),overlay.bind("click",close),overlay.appendTo("body"),overlay},animate=function(a){a.addClass("ModalNone"),setTimeout(function(){a.addClass("ModalZoom"),setTimeout(function(){a.addClass("ModalNormal"),setTimeout(function(){a.removeClass("ModalZoom"),a.removeClass("ModalNone"),a.removeClass("ModalNormal")},500)},300)},50)},showInline=function(a){var b=showOverlay();b.css("opacity","1");var c=$(window).height(),d=$(window).width();a.show().css({"z-index":1001,position:"fixed",top:(c-a.height())/2,left:(d-a.width())/2}),animate(a),$("body").one("modalClose",function(){a.hide()})},showiFrame=function(a){var b=a.attr("href"),c=$("<iframe/>").addClass("ModalContainer").attr("src",b).css("border",0);if(a.attr("data-modal-size")){var d=a.attr("data-modal-size").split("x");c.css({width:d[0],height:d[1]})}$("body").append(c),showInline(c)},show=function(a){var b=$(a.target),c=b.attr("data-modal");if(c=="inline"){var d=$(b.attr("data-modal-container"));showInline(d)}else c=="iframe"&&showiFrame(b);return window.location.hash="#modal",!1},close=function(){window.location.hash="",overlay.remove(),$("body").trigger("modalClose")},attach=function(a){a.bind("click",show)};$(function(){attach($("[data-modal]")),$("body").delegate("[data-modal-close]","click",close)});var modal={attach:attach,close:close,options:options}